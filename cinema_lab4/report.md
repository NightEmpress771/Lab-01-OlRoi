# –ó–≤—ñ—Ç –∑ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ ‚Ññ4

## –ó–∞–≥–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
- –ü–Ü–ë —Å—Ç—É–¥–µ–Ω—Ç–∞: –ë—É–≥–∞–π—á—É–∫ –î–µ–Ω–∏—Å –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á
- –ì—Ä—É–ø–∞: –Ü–ü–ó-32
- –í–∞—Ä—ñ–∞–Ω—Ç (–ø—Ä–µ–¥–º–µ—Ç–Ω–∞ –æ–±–ª–∞—Å—Ç—å): –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä—É
- –†—ñ–≤–µ–Ω—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: 3 —Ä—ñ–≤–µ–Ω—å

## –û–ø–∏—Å –ø—Ä–µ–¥–º–µ—Ç–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ
[–°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ñ—ñ–ª—å–º–∏, –∑–∞–ª–∏, —Å–µ–∞–Ω—Å–∏ –π –ø—Ä–æ–¥–∞–Ω—ñ –∫–≤–∏—Ç–∫–∏.
–û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏:

–∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ —Ñ—ñ–ª—å–º–∏ (–Ω–∞–∑–≤–∞, –∂–∞–Ω—Ä, —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, —Ü—ñ–Ω–∞, —Ä—ñ–∫ –≤–∏—Ö–æ–¥—É);

—É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–ª–∞–º–∏ —Ç–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º —Å–µ–∞–Ω—Å—ñ–≤;

—Ñ—ñ–∫—Å–∞—Ü—ñ—è –ø—Ä–æ–¥–∞–∂—ñ–≤ –∫–≤–∏—Ç–∫—ñ–≤ –∫–ª—ñ—î–Ω—Ç–∞–º;

–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç—Ä–∏–≥–µ—Ä—ñ–≤;

–ø–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ —Ä–æ–±–æ—Ç–∞ —á–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å.]

## –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞ –º–æ–¥–µ–ª—å
[–°—É—Ç–Ω–æ—Å—Ç—ñ:

–§—ñ–ª—å–º (Film) ‚Äî –º–∞—î –Ω–∞–∑–≤—É, –∂–∞–Ω—Ä, —Ä—ñ–∫ –≤–∏–ø—É—Å–∫—É, —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, —Ü—ñ–Ω—É –∫–≤–∏—Ç–∫–∞.

–ó–∞–ª (Hall) ‚Äî –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —ñ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –º—ñ—Å—Ü—å.

–°–µ–∞–Ω—Å (Session) ‚Äî –≤–∫–∞–∑—É—î —Ñ—ñ–ª—å–º, –∑–∞–ª —ñ —á–∞—Å –ø–æ–∫–∞–∑—É.

–ö–≤–∏—Ç–æ–∫ (Ticket) ‚Äî –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç–∞, –∫—É–ø–ª–µ–Ω–∏–π —Å–µ–∞–Ω—Å —ñ —á–∞—Å –ø–æ–∫—É–ø–∫–∏.

–ó–≤‚Äô—è–∑–∫–∏:

–û–¥–∏–Ω —Ñ—ñ–ª—å–º –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Å–µ–∞–Ω—Å—ñ–≤.

–û–¥–∏–Ω —Å–µ–∞–Ω—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —É –æ–¥–Ω–æ–º—É –∑–∞–ª—ñ.

–û–¥–∏–Ω –∫–ª—ñ—î–Ω—Ç –º–æ–∂–µ –∫—É–ø–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –∫–≤–∏—Ç–∫—ñ–≤.]
![ER-–¥—ñ–∞–≥—Ä–∞–º–∞](image.png)

## –õ–æ–≥—ñ—á–Ω–∞ —Å—Ö–µ–º–∞
[–¢–∞–±–ª–∏—Ü—ñ:

films(film_id, title, genre, duration, price, release_year)

halls(hall_id, name, capacity)

sessions(session_id, film_id, hall_id, session_time)

tickets(ticket_id, session_id, customer_name, purchase_time)

–ó–≤‚Äô—è–∑–∫–∏:

sessions.film_id ‚Üí films.film_id

sessions.hall_id ‚Üí halls.hall_id

tickets.session_id ‚Üí sessions.session_id]

## –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤ PostgreSQL
[–û—Å–Ω–æ–≤–Ω—ñ SQL-—Å–∫—Ä–∏–ø—Ç–∏:

01_create_tables.sql ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å
02_insert_data.sql ‚Äî –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –¥–∞–Ω–∏—Ö
03_create_views.sql ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É
04_create_procedures.sql ‚Äî –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∫–≤–∏—Ç–∫—ñ–≤)
05_create_triggers.sql ‚Äî —Ç—Ä–∏–≥–µ—Ä–∏, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—é—Ç—å –¥–∞–Ω—ñ –ø—Ä–∏ –ø–æ–∫—É–ø—Ü—ñ –∫–≤–∏—Ç–∫–∞]

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Docker
[Docker –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Ü—å–æ–º—É –≤–∞—Ä—ñ–∞–Ω—Ç—ñ.]

## SQL-–∑–∞–ø–∏—Ç–∏
[–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤, —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä—É:

## 1. –í–∏–≤–µ—Å—Ç–∏ –≤—Å—ñ —Ñ—ñ–ª—å–º–∏, —è–∫—ñ –ø–æ–∫–∞–∑—É—é—Ç—å—Å—è —É –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä—ñ

```sql
SELECT title, genre, duration, release_date
FROM films;
‚Äã`‚Äã`‚Äã`
### –ü–æ—è—Å–Ω–µ–Ω–Ω—è:
–ó–∞–ø–∏—Ç –≤–∏–≤–æ–¥–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤—Å—ñ —Ñ—ñ–ª—å–º–∏, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ —Ç–∞–±–ª–∏—Ü—ñ films.


## 2. –í–∏–≤–µ—Å—Ç–∏ –≤—Å—ñ —Å–µ–∞–Ω—Å–∏ —ñ–∑ –∑–∞–∑–Ω–∞—á–µ–Ω–Ω—è–º —Ñ—ñ–ª—å–º—É —Ç–∞ –∑–∞–ª—É
‚Äã
```sql
SELECT s.session_id, f.title AS film, h.name AS hall, s.session_time
FROM sessions s
JOIN films f ON s.film_id = f.film_id
JOIN halls h ON s.hall_id = h.hall_id;
```

### –ü–æ—è—Å–Ω–µ–Ω–Ω—è:
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ JOIN –¥–ª—è –ø–æ—î–¥–Ω–∞–Ω–Ω—è —Ç—Ä—å–æ—Ö —Ç–∞–±–ª–∏—Ü—å —ñ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–≤–µ–¥–µ–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Å–µ–∞–Ω—Å–∏.

## 3. –ó–Ω–∞–π—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–Ω–∏—Ö –∫–≤–∏—Ç–∫—ñ–≤ –Ω–∞ –∫–æ–∂–µ–Ω —Ñ—ñ–ª—å–º

SELECT f.title, COUNT(t.ticket_id) AS sold_tickets
FROM tickets t
JOIN sessions s ON t.session_id = s.session_id
JOIN films f ON s.film_id = f.film_id
GROUP BY f.title;


–ü–æ—è—Å–Ω–µ–Ω–Ω—è:
–ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è COUNT() –¥–æ–∑–≤–æ–ª—è—î –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∏—Ç–∫—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ñ—ñ–ª—å–º—É.

## 4. –ü–æ—à—É–∫ —Ñ—ñ–ª—å–º—ñ–≤ –∑–∞ –∂–∞–Ω—Ä–æ–º (—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó)

SELECT * FROM films
WHERE genre ILIKE '%' || %(genre)s || '%';


–ü–æ—è—Å–Ω–µ–Ω–Ω—è:
–¶–µ–π –∑–∞–ø–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤–µ–±—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ /films –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ñ—ñ–ª—å–º—ñ–≤ –∑–∞ –≤–≤–µ–¥–µ–Ω–∏–º –∂–∞–Ω—Ä–æ–º.]

## –ö–æ–Ω—Å–æ–ª—å–Ω–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫
[![C–∫—Ä—ñ–Ω—à–æ—Ç](image-6.png)]


## –í–µ–±–∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ 
[
![–°–∫—Ä—ñ–Ω—à–æ—Ç 1](image-1.png)
![–°–∫—Ä—ñ–Ω—à–æ—Ç 2](image-2.png)
![–°–∫—Ä—ñ–Ω—à–æ—Ç 3](image-3.png)
![–°–∫—Ä—ñ–Ω—à–æ—Ç 4](image-4.png)
![–°–∫—Ä—ñ–Ω—à–æ—Ç 5](image-5.png)
]


## –†–æ–∑—à–∏—Ä–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å (—Ä—ñ–≤–µ–Ω—å 3, —è–∫—â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ)
[–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é —Ñ—ñ–ª—å–º—ñ–≤ –∑–∞ –∂–∞–Ω—Ä–æ–º –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ /films —á–µ—Ä–µ–∑ HTML-—Ñ–æ—Ä–º—É —Ç–∞ SQL LIKE-–∑–∞–ø–∏—Ç:
@app.route('/films', methods=['GET', 'POST'])
def films():
    if request.method == 'POST':
        genre_filter = request.form.get('genre')
        query = """
            SELECT film_id, title, genre, duration, price, release_year
            FROM films
            WHERE LOWER(genre) LIKE LOWER(%s)
            ORDER BY title;
        """
        films_data = fetch_all(query, ('%' + genre_filter + '%',))
    else:
        query = "SELECT * FROM films ORDER BY title;"
        films_data = fetch_all(query)
    return render_template('films.html', films=films_data)

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –≤–≤–µ—Å—Ç–∏ –∂–∞–Ω—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–ì–æ—Ä–æ—Ä") —ñ –ø–æ–±–∞—á–∏—Ç–∏ –ª–∏—à–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —Ñ—ñ–ª—å–º–∏.
]

## –í–∏—Å–Ω–æ–≤–∫–∏
[–£ —Ö–æ–¥—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏:

–°—Ç–≤–æ—Ä–µ–Ω–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö ¬´–ö—ñ–Ω–æ—Ç–µ–∞—Ç—Ä¬ª —É PostgreSQL;

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç–∞–±–ª–∏—Ü—ñ, –∑–≤‚Äô—è–∑–∫–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è, –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ —Ç–∞ —Ç—Ä–∏–≥–µ—Ä–∏;

–ü–æ–±—É–¥–æ–≤–∞–Ω–æ –∫–æ–Ω—Å–æ–ª—å–Ω–∏–π —ñ –≤–µ–±—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –±–∞–∑–æ—é;

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –¥–æ–¥–∞—Ç–∫–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å ‚Äî —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –∑–∞ –∂–∞–Ω—Ä–æ–º;

–ù–∞–±—É—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö –Ω–∞–≤–∏—á–æ–∫ —Ä–æ–±–æ—Ç–∏ –∑ SQL, PostgreSQL —Ç–∞ Flask.

üí° –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —î –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä–æ–º —ñ–∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –ø–µ—Ä–µ–≥–ª—è–¥—É, –ø—Ä–æ–¥–∞–∂—É –∫–≤–∏—Ç–∫—ñ–≤ —ñ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ñ—ñ–ª—å–º—ñ–≤ —á–µ—Ä–µ–∑ –≤–µ–±—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

]




